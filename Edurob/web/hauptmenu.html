<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduRob Settings</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="layout-col">
        <h1>EduRob Settings</h1>
        <div class="status-container">
            <div class="status">
                <div class="status-title">Radabstand:</div>
                <div class="status-value" id="radabstand">Loading...</div>
            </div>
            <div class="status">
                <div class="status-title">Axenabstand:</div>
                <div class="status-value" id="axenabstand">Loading...</div>
            </div>
            <div class="status">
                <div class="status-title">Radradius:</div>
                <div class="status-value" id="radradius">Loading...</div>
            </div>
            <div class="status">
                <div class="status-title">Encoderauflösung:</div>
                <div class="status-value" id="encoderaufloesung">Loading...</div>
            </div>
            <div class="status">
                <div class="status-title">Übersetzung:</div>
                <div class="status-value" id="uebersetzung">Loading...</div>
            </div>
            <div class="status">
                <div class="status-title">Kinematik:</div>
                <div class="status-value" id="kinematik">Loading...</div>
            </div>
        </div>
        <button class="link" onclick="window.location.href='/configuration'" >Zu EduRob Settings</button>
        <button id="kinematikButton" class="link">Zu Kinematik</button>
        <!-- Reboot Button -->
        <button class="link" onclick="sendReboot()" >Neustart</button>

    </div>

    <script>
        // Initialize Server-Sent Events (SSE)
        let eventSource = new EventSource('/sse?type=index');

        // Update status values  and Link when receiving events
        eventSource.onmessage = function(event) {
            const data = JSON.parse(event.data);
            document.getElementById('radabstand').innerHTML = data.radabstand;
            document.getElementById('axenabstand').innerHTML = data.axenabstand;
            document.getElementById('radradius').innerHTML = data.radradius;
            document.getElementById('encoderaufloesung').innerHTML = data.encoderaufloesung;
            document.getElementById('uebersetzung').innerHTML = data.uebersetzung;
            document.getElementById('kinematik').innerHTML = data.kinematik;
            updateKinematikButton(data.kinematik);
            eventSource.close();
        };

        function updateKinematikButton(kinematik) {
            const button = document.getElementById("kinematikButton");

            // Entscheide hier je nach Kinematik-Typ
            switch (kinematik.toLowerCase()) {
                case "mecanum":
                    button.onclick = () => window.location.href = "/mecanum";
                    break;

                case "omni4":
                    button.onclick = () => window.location.href = "/omnifour";
                    break;

                case "omni3":
                    button.onclick = () => window.location.href = "/omnithree";
                    break;
                case "differential":
                    button.onclick = () => window.location.href = "/differential";
                    break;
                default:
                    // Fallback
                    button.onclick = () => window.location.href = "/kinematiklinks";
            }
        }
        // Send reboot request with the current selected checkbox state
        function sendReboot() {

            window.location.href = `/reboot?selected=${selectedValue}`;
        }

    </script>
</body>
</html>